---
import '../styles/globals.css'

export interface Props {
  metadata?: {
    title?: string
    description?: string
    canonical?: string
    image?: string
  }
}

const {
  metadata = {
    title: 'jaRule - Master of All Things Smooth',
    description: 'The most opinionated dotfiles in the Joloverse',
    canonical: 'https://jarule.dev',
  },
} = Astro.props

const { title, description, canonical, image } = metadata
const canonicalURL = canonical || new URL(Astro.url.pathname, Astro.site).href
const socialImage = image || new URL('/og-image.png', Astro.site).href
---

<!doctype html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />

    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />

    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="description" content={description} />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={socialImage} />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalURL} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={socialImage} />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link 
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" 
      rel="stylesheet" 
    />

    <!-- Theme Color -->
    <meta name="theme-color" content="#1e1e2e" />
    <meta name="color-scheme" content="dark light" />

    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />

    <!-- Manifest -->
    <link rel="manifest" href="/site.webmanifest" />

    <!-- Preload critical resources -->
    <link rel="preload" href="/fonts/CascadiaCode.woff2" as="font" type="font/woff2" crossorigin />

    <!-- Analytics and Performance -->
    <script is:inline>
      // Theme detection and application
      (function() {
        const theme = localStorage.getItem('theme') || 'dark'
        document.documentElement.classList.toggle('dark', theme === 'dark')
      })()
    </script>
  </head>
  
  <body class="antialiased">
    <!-- Navigation will be added here -->
    <nav class="fixed top-0 w-full z-50 bg-background/80 backdrop-blur-sm border-b border-border">
      <div class="container mx-auto px-4 py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-2">
            <span class="text-2xl font-bold gradient-text">jaRule</span>
            <span class="text-sm text-muted-foreground">v1.0</span>
          </div>
          
          <div class="hidden md:flex items-center space-x-6">
            <a href="#features" class="text-sm hover:text-primary transition-colors">Features</a>
            <a href="#philosophy" class="text-sm hover:text-primary transition-colors">Philosophy</a>
            <a href="#showcase" class="text-sm hover:text-primary transition-colors">Showcase</a>
            <a href="https://github.com/contact411/jaRules" target="_blank" rel="noopener noreferrer" 
               class="text-sm hover:text-primary transition-colors">GitHub</a>
          </div>

          <!-- Mobile menu button -->
          <button class="md:hidden p-2" aria-label="Toggle menu">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
      </div>
    </nav>

    <!-- Main content -->
    <main class="pt-16">
      <slot />
    </main>

    <!-- Footer -->
    <footer class="bg-card border-t border-border mt-20">
      <div class="container mx-auto px-4 py-12">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <!-- Brand -->
          <div class="space-y-4">
            <div class="flex items-center space-x-2">
              <span class="text-xl font-bold gradient-text">jaRule</span>
            </div>
            <p class="text-sm text-muted-foreground">
              Master of All Things Smooth. The most opinionated dotfiles in the Joloverse.
            </p>
          </div>

          <!-- Quick Links -->
          <div class="space-y-4">
            <h3 class="font-semibold">Quick Start</h3>
            <ul class="space-y-2 text-sm text-muted-foreground">
              <li><a href="#installation" class="hover:text-primary transition-colors">Installation</a></li>
              <li><a href="#features" class="hover:text-primary transition-colors">Features</a></li>
              <li><a href="/docs" class="hover:text-primary transition-colors">Documentation</a></li>
            </ul>
          </div>

          <!-- Resources -->
          <div class="space-y-4">
            <h3 class="font-semibold">Resources</h3>
            <ul class="space-y-2 text-sm text-muted-foreground">
              <li><a href="https://github.com/contact411/jaRules" target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors">GitHub</a></li>
              <li><a href="https://github.com/contact411/jaRules/blob/main/docs/DOTFILES.md" target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors">Configuration Guide</a></li>
              <li><a href="/api/version" class="hover:text-primary transition-colors">Version Info</a></li>
            </ul>
          </div>

          <!-- Credits -->
          <div class="space-y-4">
            <h3 class="font-semibold">Credits</h3>
            <ul class="space-y-2 text-sm text-muted-foreground">
              <li><a href="https://github.com/axelquack/dotfiles-macos" target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors">AxelQuack (Inspiration)</a></li>
              <li><span>Joloverse Initiative</span></li>
              <li><span>Built with ❤️ and ☕</span></li>
            </ul>
          </div>
        </div>

        <div class="border-t border-border mt-8 pt-8 flex flex-col md:flex-row justify-between items-center">
          <p class="text-sm text-muted-foreground">
            © 2024 jaRule. Standing on the shoulders of giants to build something even more magnificent.
          </p>
          
          <div class="flex items-center space-x-4 mt-4 md:mt-0">
            <span class="text-xs text-muted-foreground">Generated with</span>
            <a href="https://claude.ai/code" target="_blank" rel="noopener noreferrer" class="text-xs text-primary hover:underline">Claude Code</a>
          </div>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script is:inline>
      // Smooth scrolling for anchor links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault()
          const target = document.querySelector(this.getAttribute('href'))
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' })
          }
        })
      })

      // Add scroll effect to navigation
      window.addEventListener('scroll', () => {
        const nav = document.querySelector('nav')
        if (window.scrollY > 100) {
          nav?.classList.add('bg-background/95')
        } else {
          nav?.classList.remove('bg-background/95')
        }
      })
    </script>
  </body>
</html>